{% set page = { title: "LesJours", class: "home" } %}
{% extends "partials/_layout.html" %}

{% macro author(episode) %}
	{% for group in episode.rel.authors %}{% set group = group|expand %}{% for kind, authors in group %}{% if kind == "text" %}{% for author in authors if authors.push else [authors] %}{% if author.href %}<a class="link-unstyled" rel="author" href="{{ author.href }}">{% endif %}{{ author.name if author.name else author }}{% if author.href %}</a>{% endif %}{% if loop.length > 1 and not loop.last %}{{ " et " if loop.revindex0 == 1 else ", " }}{% endif %}{% endfor %}{% endif %}{% endfor %}{% endfor %}
{% endmacro %}
{% from "partials/_macro.html" import authors %}

{% block content %}
<section class="container sm-ph-0">
	<div class="row">
		<div class="col sm-ph-0">
			<h2 class="sr">À la une</h2>
			{% set episode   = home.master|expand %}
			{% set obsession = episode.obsession|expand %}
			{%
				set cover = {
					class: "no-pattern obsession-" + obsession.color,
					layout: "pv-5g sm-ph-2g md-pl-1c md-w-4c lg-pl-1c lg-w-5c",
					img: "/obsessions/" + obsession.href + "/" + episode.href + "/" + episode.img|default("img/header.jpg"),
					href: "/obsessions/" + obsession.href + "/" + episode.href,
					title:    episode.title,
					subtitle: episode.subtitle,
					episode:  episode
				}
			%}
			{% include "partials/cover.html" %}
		</div>
	</div>
	{% if home.articles %}
	<div class="row articles">
		<div class="col sm-mb-4g md-w-4c lg-ml-1c lg-w-5c pl-4g obsession-{{ home.articles[0].obsession.color }}">
			<h3 class="h3 snake-1"><a href="/obsessions/{{ home.articles[0].obsession.href }}/{{ home.articles[0].href }}" class="snake-container link-unstyled">{{ home.articles[0].title }}</a></h3>
			<p>{{ home.articles[0].intro }}</p>
			<p class="style-meta color-inherit"><a class="link-unstyled" href="/obsessions/{{ home.articles[0].obsession.href }}">{{ home.articles[0].obsession.name }}</a> • épisode n°{{ home.articles[0].number }}</p>
			<span class="style-meta">Par {{ author(home.articles[0]) }}</span>
		</div>
		<div class="col md-w-4c lg-w-5c pl-4g obsession-{{ home.articles[1].obsession.color }}">
			<h3 class="h3 snake-1"><a href="/obsessions/{{ home.articles[1].obsession.href }}/{{ home.articles[1].href }}" class="snake-container link-unstyled">{{ home.articles[1].title }}</a></h3>
			<p>{{ home.articles[1].intro }}</p>
			<p class="style-meta color-inherit"><a class="link-unstyled" href="/obsessions/{{ home.articles[1].obsession.href }}">{{ home.articles[1].obsession.name }}</a> • épisode n°{{ home.articles[1].number }}</p>
			<span class="style-meta">Par {{ author(home.articles[1]) }}</span>
		</div>
	</div>
	{% endif %}
</section>
{% if home.obsessions %}
<hr/>
<section class="container">
	<h2 class="pl-1g mb-1g lg-ml-1c style-meta-larger">Nos obsessions</h2>
	<ul class="obsessions row lg-mh-1c">
		{% for obsession in home.obsessions %}
			{% set obsession = obsession|expand %}
			<li class="col pa-1g obsession-{{ obsession.color }}">
				{%
					set cover = {
						class: "small",
						img: "/obsessions/" + obsession.href + "/" + obsession.href + ".jpg",
						href: "/obsessions/" + obsession.href,
						title: obsession.title,
						subtitle: obsession.subtitle
					}
				%}
				{% include "partials/cover.html" %}
			</li>
		{% endfor %}
	</ul>
</section>
{% endif %}

<hr/>
<section class="text-center">
	<h2 class="style-meta-large">Au fil des jours</h2>
	<ul class="list-unstyled list-inline mv-3g">
		<li class="col w-auto"><a class="btn-round" href="https://twitter.com/Lesjoursfr"><i>{{ icon("twitter", "Twitter") }}</i></a></li>
		<li class="col w-auto"><a class="btn-round" href="https://www.facebook.com/LesJoursfr/"><i>{{ icon("facebook", "Facebook") }}</i></a></li>
		<li class="col w-auto"><a class="btn-round" href="https://www.instagram.com/lesjoursfr/"><i>{{ icon("instagram", "Instagram") }}</i></a></li>
	</ul>
</section>
{% include "partials/_footer.html" %}
{% endblock %}